extends: spectral:oas
functions: [recordkey, operations, serverurl, post_operations]
rules:
  no-$ref-siblings: false
  component-name-rule:
    severity: error
    recommended: true
    message: Semantic error - Component names can only contain the characters A-Z a-z 0-9 - . _
    given: $..components.schemas[*]~
    then:
      function: pattern
      functionOptions:
        match: "^[a-zA-Z0-9\\.\\-_]+$"

  pascal-case-name-rule:
    severity: error
    recommended: true
    message: OperationId should be pascalCased.
    type: style
    given: "$.paths.[*].operationId"
    then:
      function: casing
      functionOptions:
        type: pascal

  pascal-case-param-name-rule:
    severity: error
    recommended: true
    message: Path parameter names should be capitalized.
    type: style
    given: "$.paths.[*].parameters.[*].name"
    then:
      function: pattern
      functionOptions:
        match: "^[A-Z].*"

  require-openapi-rule:
    severity: error
    message: openapi field must be present with a non empty value
    given: $
    then:
      field: openapi
      function: truthy

  operation-id-length-rule:
    severity: warn
    message: OperationID length should be between 4 and 50
    given: "$.paths.[*].operationId"
    then:
      function: length
      functionOptions:
        max: 50
        min: 4

  list-operation-record-key:
    message: "Response object does not have 2xx operation or default set"
    given: "$.paths"
    severity: error
    then:
      function: recordkey
  
  operation-id-convention:
    message: "{{error}}"
    given: "$.paths"
    severity: error
    then:
      function: operations

  valid-server-url:
    message: "{{error}}"
    given: "$"
    severity: error
    then:
      function: serverurl
  
  update-operation:
    message: "{{error}}"
    given: "$.paths"
    severity: error
    then:
      function: post_operations

  oas3-valid-oas-content-example: off
  oas3-valid-oas-parameter-example: off